from config.colours import (
    exception_error,
    process,
    success,
    separator,
)


def pe_tools(pe):
    """Tools to show PE Sections and imports"""
    def pe_sections():
        try:
            process("Displaying Sections:\n")
            for section in pe.sections:
                process(f"{section.Name}\n{hex(section.VirtualAddress)}\n{hex(section.Misc_VirtualSize)}\n{section.SizeOfRawData}")
            separator()

        except Exception as e:
            exception_error(e)

    def pe_imports():
        try:
            process("Displaying Imports:\n")
            for entry in pe.DIRECTORY_ENTRY_IMPORT:
                process(entry.dll)
                for function in entry.imports:
                    success(f"\t[cyan]{function.name}[/cyan]")
            separator()

        except Exception as e:
            exception_error(e)

    return pe_sections, pe_imports
