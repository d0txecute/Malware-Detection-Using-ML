import pefile
import os
import rich

path = "payloads"
files = os.listdir(path)

for index,file in enumerate(files):
    print(f"[{index}]: {file}")

malfile = input("\nEnter File Name: ")
malpath = f"{path}/{malfile}"
pe = pefile.PE(malpath)

print("\nDisplaying Sections:")
for section in pe.sections:
    print(section.Name, 
    hex(section.VirtualAddress),
    hex(section.Misc_VirtualSize), 
    section.SizeOfRawData)

print("\nDisplaying Imports:")
for entry in pe.DIRECTORY_ENTRY_IMPORT:
    print (entry.dll)
    for function in entry.imports:
        print ('\t',function.name)
